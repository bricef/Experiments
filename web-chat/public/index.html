<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
  <script src="https://unpkg.com/htmx.org@2.0.3"></script>
  <script src="https://unpkg.com/htmx-ext-ws@2.0.1/ws.js"></script>
  <script src="https://unpkg.com/hyperscript.org@0.9.13"></script>
  <title>Chat Example</title>
</head>


<body>
  
  <div class="container">
    <header>
      <h1>Chat Example</h1>
    </header>
    <div>
      
      <article style="visibility: visible">
        <form hx-post="/register" hx-target="#app">
          <label for="nick">Choose your user name:</label>
          <input type="text" name="nick" placeholder="choose your user name">
          <button>Choose Username</button>
        </form>
      </article>

      <article style="visibility: hidden;">
        <div hx-ext="ws" ws-connect="/chatroom">
          <h3>Your name is: {{name}}</h3>
          <div id="chat_room">
          </div>
          <form id="form" ws-send>
            <input name="chat_message">
          </form>
        </div>
      </article>

    </div>
  </div>

  <script>
    // var loc = window.location
    // var uri = 'ws:';

    // if (loc.protocol === 'https:') {
    //   uri = 'wss:';
    // }
    // uri += '//' + loc.host;
    // uri += '/chatroom';

    // ws = new WebSocket(uri)

    // ws.onopen = function() {
    //   console.log('Connected')
    // }

    // ws.onmessage = function(evt) {
    //   var out = document.getElementById('chat_room');
    //   out.innerHTML += evt.data + '<br>';
    // }

  </script>
</body>

</html>
